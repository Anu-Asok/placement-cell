<html>
  <head>

  </head>
  <body>
    <form id="sheets">
      <input type="file" id="sheet1"/>
      <input type="file" id="sheet2"/>
      <input type="submit" id="submit-btn">
    </form>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
      var sheets = document.getElementById('sheets');
      sheets.addEventListener('submit', function(e){
        e.preventDefault();
      });
      var sheetobj1, sheetobj2;
      var rABS = true; // true: readAsBinaryString ; false: readAsArrayBuffer
      function handleFile1(e) {
        var files = e.target.files, f = files[0];
	      console.log(f);
        var reader = new FileReader();
        reader.onload = function(e) {
          var data = e.target.result;
          if(!rABS) data = new Uint8Array(data);
          var workbook = XLSX.read(data, {type: rABS ? 'binary' : 'array'});
          var first_sheet_name = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[first_sheet_name];
          console.log(XLSX.utils.sheet_to_json(worksheet));
          sheetobj1=XLSX.utils.sheet_to_json(worksheet)
          // worksheet=XLSX.utils.json_to_sheet(worksheet);
          // workbook.Sheets[first_sheet_name]=worksheet;
          // XLSX.writeFile(workbook, 'out.xlsx');
        };
        if(rABS) reader.readAsBinaryString(f); else reader.readAsArrayBuffer(f);
      }
      function handleFile2(e) {
        var files = e.target.files, f = files[0];
        var reader = new FileReader();
        reader.onload = function(e) {
          var data = e.target.result;
          if(!rABS) data = new Uint8Array(data);
          var workbook = XLSX.read(data, {type: rABS ? 'binary' : 'array'});
          var first_sheet_name = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[first_sheet_name];
          console.log(XLSX.utils.sheet_to_json(worksheet));
          sheetobj2=XLSX.utils.sheet_to_json(worksheet)
          
          console.table(sheetobj1);
          console.table(sheetobj2);
          var k = 'REGISTER NO.';
          for(var i =0 ;i<sheetobj2.length;i++){
            for(var j=0 ; j<sheetobj1.length;j++){
              var a = sheetobj2[Object.keys(sheetobj2)[i]];
              var b = sheetobj1[Object.keys(sheetobj1)[j]];
              if(a[k] == b[k])
                console.table(sheetobj1[Object.keys(sheetobj1)[j]]);
            }
          }

          // worksheet=XLSX.utils.json_to_sheet(worksheet);
          // workbook.Sheets[first_sheet_name]=worksheet;
          // XLSX.writeFile(workbook, 'out.xlsx');
        };
        if(rABS) reader.readAsBinaryString(f); else reader.readAsArrayBuffer(f);
      }
      var sheet1 = document.getElementById('sheet1');
      var sheet2 = document.getElementById('sheet2');
      
      sheet1.addEventListener('input', handleFile1, false);
      sheet2.addEventListener('input', handleFile2, false);
    </script>
  </body>
</html>
